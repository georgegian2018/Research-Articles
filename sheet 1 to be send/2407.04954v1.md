
**Extracted Content and Technical Documentation**

---

## Document Information

**Title:** Extremely Large-Scale Dynamic Metasurface Antennas (XL-DMAs): Near-Field Modeling and Channel Estimation

**Authors:** Songjie Yang, Wanting Lyu, Boyu Ning, Yue Xiu, Youzhi Xiong, Hua Chen, Chadi Assi, Chau Yuen

**Publication Date:** July 6, 2024

**ArXiv Reference:** 2407.04954v1

**Research Areas:** Signal Processing, Wireless Communications, MIMO Systems, 6G Technologies

---

## Figures and Illustrations

### Figure 1: DMA Structure and Coordinate System Model

**Caption:** The DMA structure and its three-dimensional coordinate system model.

**Description:** This figure illustrates the physical structure of Dynamic Metasurface Antennas showing the three-dimensional coordinate system with M RF chains each connected to a microstrip containing N metasurface elements arranged along the y-axis and z-axis.

### Figure 2: Feasible Range of Weights

**Caption:** The feasible range of weights for DMAs and phased-arrays.

**Description:** Comparison of the complex weight space between Dynamic Metasurface Antennas (subject to Lorentzian constraint) and conventional phased arrays. DMAs have restricted phase ranges compared to ideal phased arrays.

### Figure 3: Three Kinds of Propagation Models

**Caption:** Three kinds of propagation models in EL-AZ directions.

**Description:** Illustrates three different propagation models:
- (a) Spherical-wave propagation model
- (b) Planar-wave propagation model  
- (c) Proposed cross-field model combining spherical and planar wave propagation

### Figure 4: Element Distance Analysis

**Caption:** Element distance versus the antenna index with different models. r = 3, ϑ = φ = 0.25, and λ = 0.0107.

**Subfigures:**
- **(a) A UPA of 128 × 8:** Comparison of element distances across different propagation models for a 128×8 uniform planar array
- **(b) A UPA of 128 × 32:** Extended comparison for a larger 128×32 array, showing increased differences between approximation methods

**Analysis:** Demonstrates that the proposed Oblong Approximation model closely aligns with the second-order Taylor approximation while remaining simpler than spherical wavefront models.

### Figure 5: Beamforming Gain Analysis

**Caption:** Beamforming gain versus the communication distance with λ = 0.0107.

**Subfigures:**
- **(a) ϑ = φ = 0.25:** Beamforming gain performance at specific angle parameters
- **(b) ϑ = φ = 0.5:** Performance at different angle parameters

**Analysis:** Shows the effectiveness of the Oblong Approximation model in matching spherical wavefront behavior as communication distance increases, particularly in near-field regions below 50 meters.

### Figure 6: Channel Estimation Performance (NMSE vs SNR)

**Caption:** The NMSE versus SNR of different methods. MMO for DMAs is considered.

**Subfigures:**
- **(a) M = 4, P = 20:** Performance with 4 RF chains and 20 pilot symbols
- **(b) M = 4, P = 10:** Performance with reduced pilot symbols
- **(c) M = 8, P = 20:** Performance with increased RF chains

**Analysis:** Normalized Mean Square Error (NMSE) comparison across SNR range of -20 to 12 dB for multiple estimation methods.

### Figure 7: NMSE Comparison - Phased Array Reference

**Caption:** The NMSE versus SNR of different methods. M = 4, P = 20. MMO for phased-arrays is considered.

**Analysis:** Demonstrates performance degradation of DMAs compared to ideal phased arrays due to Lorentzian constraints.

### Figure 8: NMSE with Random Measurement Matrix

**Caption:** The NMSE versus SNR of different methods. M = 4, P = 20. Gaussian random measurement matrix for DMAs is considered.

**Analysis:** Evaluates performance without measurement matrix optimization.

### Figure 9: Phased Array Performance - Random Measurement Matrix

**Caption:** The NMSE versus SNR of different methods. M = 4, P = 20. Gaussian random measurement matrix for phased-arrays is considered.

### Figure 10: Computational Complexity Analysis

**Caption:** The running time versus N.

**Description:** Demonstrates linear time complexity of different estimation algorithms with respect to the number of metasurface elements N (ranging from 32 to 256). Shows that AZ-IE and EL-AZ-DE have comparable computational speeds, while OG-EL-AZ-DE has slightly higher complexity due to off-grid refinement procedures.

---

## Tables and Tabular Data

### Table I: Element Distance Parameter Comparison

**Caption:** Element Distance Parameter Comparison using ULAs and UPAs in Different Propagation Models

| Array Layout | Propagation Model | Element Distance r(m,n) | Applicable Region |
|---|---|---|---|
| **ULA (along y-axis)** | Spherical Wavefront | $\sqrt{r^2 - 2r(n-1)d\varphi + ((n-1)d)^2}$ | Near to far field |
| | Second-order Taylor Approx. | $r - (n-1)d\varphi + \frac{((n-1)d)^2}{2r}(1-\varphi^2)$ | Near field |
| | Proposed Oblong Approx. | $r - (n-1)d\varphi + \frac{((n-1)d)^2}{2r}(1-\varphi^2)$ | Near field |
| | Planar Wavefront (Far-Field) | $r - (n-1)d\varphi$ | Far field |
| **UPA (along y-z-plane)** | Spherical Wavefront | $\sqrt{r^2 - 2r(n-1)d\varphi + ((n-1)d)^2 - 2r(m-1)d\vartheta + ((m-1)d)^2}$ | Near to far field |
| | Second-order Taylor Approx. | $r - (n-1)d\varphi - (m-1)d\vartheta + \frac{((m-1)d)^2}{2r}(1-\vartheta^2) + \frac{((n-1)d)^2}{2r}(1-\varphi^2) - \frac{(n-1)(m-1)d^2\varphi\vartheta}{r}$ | Near field |
| | Proposed Oblong Approx. | $r - (n-1)d\varphi - (m-1)d\vartheta + \frac{((n-1)d)^2}{2r}(1-\varphi^2)$ | Near field |
| | Planar Wavefront (Far-Field) | $r - (n-1)d\varphi - (m-1)d\vartheta$ | Far field |

**Key Insights:**
- The proposed Oblong Approximation simplifies the UPA model compared to second-order Taylor expansion
- Removes coupled φ-ϑ cross terms that complicate processing
- Maintains accuracy comparable to more complex models while achieving computational efficiency

---

## Equations and Mathematical Models

### I. Fundamental Channel Model

$$h = \sum_{l=1}^{L} z_l g(\theta_l, \phi_l, r_l) = Gz$$

where:
- $L$ is the number of channel paths
- $z_l$ denotes the complex gain of the l-th path
- $G = [g(\theta_1, \phi_1, r_1), \cdots, g(\theta_L, \phi_L, r_L)] \in \mathbb{C}^{MN \times L}$

### II. Array Manifold (Spherical Wavefront)

$$g(\theta, \phi, r) = \frac{1}{\sqrt{MN}}\left[e^{-j\frac{2\pi}{\lambda}(r^{(1,1)}-r)}, \cdots, e^{-j\frac{2\pi}{\lambda}(r^{(M,N)}-r)}\right]^T$$

where $r^{(m,n)}$ is the distance between the (m,n)-th element and the target object.

### III. Element Distance Calculation

$$r^{(n,m)} = \sqrt{r^2 - 2r(n-1)d\sin(\theta)\sin(\phi) + ((n-1)d)^2 - 2r(m-1)d\cos(\theta) + ((m-1)d)^2}$$

Approximated by second-order Taylor expansion:

$$r^{(n,m)} \approx r - (n-1)d\sin(\theta)\sin(\phi) - (m-1)d\cos(\theta) + \frac{((m-1)d)^2}{2r}(1-\cos^2(\theta)) + \frac{((n-1)d)^2}{2r}(1-\sin^2(\theta)\sin^2(\phi)) - \frac{(n-1)(m-1)d^2\sin(\theta)\sin(\phi)\cos(\theta)}{r} + \cdots$$

### IV. Proposed Oblong Approximation Model

$$g(\theta, \phi, r) \approx g_D(\theta, \phi, r) = a(\vartheta) \otimes b(\varphi, r)$$

where $\vartheta = \cos(\theta)$ and $\varphi = \sin(\theta)\cos(\phi)$

**Elevation Component (Far-field assumption):**
$$a(\vartheta) = \frac{1}{\sqrt{M}}\left[1, e^{j\frac{2\pi}{\lambda}d\vartheta}, \cdots, e^{j\frac{2\pi}{\lambda}(M-1)d\vartheta}\right]^T$$

**Azimuth Component (Near-field model):**
$$b(\varphi, r) = \frac{1}{\sqrt{N}}\left[1, e^{j\frac{2\pi}{\lambda}(d\varphi - \frac{d^2}{2r}(1-\varphi^2))}, \cdots, e^{j\frac{2\pi}{\lambda}((N-1)d\varphi - \frac{((N-1)d)^2}{2r}(1-\varphi^2))}\right]^T$$

### V. DMA Element Configuration (Lorentzian Constraint)

$$q \in \mathcal{Q} = \left\{\frac{1 + e^{jx}}{2} \Big| x \in [0, 2\pi]\right\}$$

where $x$ represents the configurable phase shift. This constraint restricts feasible phases to the range [0, π] with corresponding amplitude constraints.

### VI. Waveguide Propagation Effect

$$v_{m,n} = e^{-\rho_{m,n}(\alpha_m + j\beta_m)}, \quad \forall m, n$$

where:
- $\rho_{m,n}$ is the location of the n-th element on microstrip m
- $\alpha_m$ is the attenuation coefficient
- $\beta_m$ is the wavenumber of microstrip m

### VII. Received Signal Model

**Single pilot:**
$$y_{m,p} = \mathbf{q}_m^H V_m \mathbf{h}_m s_p + \mathbf{q}_m^H V_m \mathbf{n}_{m,p}$$

**Multiple pilots:**
$$\mathbf{y}_m = \mathbf{W}_m^H \mathbf{h}_m + \tilde{\mathbf{n}}_m$$

where $\mathbf{W}_m = V_m^H Q_m \in \mathbb{C}^{N \times P}$

### VIII. Joint Estimation Problem (EL-AZ-JE)

$$\arg\min_{\vartheta,\varphi,r} \|z\|_0 \quad \text{s.t.} \quad \left\|\mathbf{y} - \tilde{\mathbf{W}}^H\tilde{G}z\right\|_2^2 \leq \epsilon$$

### IX. Distributed Compressive Sensing (AZ Parameter Estimation)

$$\arg\min_{\varphi,r} \sum_{m=1}^{M} \|\xi_m\|_0 \quad \text{s.t.} \quad \sum_{m=1}^{M} \left\|\mathbf{y}_m - \mathbf{W}_m^H B\xi_m\right\|_2^2 \leq \epsilon, \quad \text{supp}(\xi_1) = \cdots = \text{supp}(\xi_M)$$

### X. EL Angle Estimation

$$\hat{\vartheta}_l = \arg\max_{\vartheta_l} \left|\mathbf{a}^H(\vartheta_l)\mathbf{z}_l\right|$$

### XI. Measurement Matrix Optimization Problem

$$\arg\min_Q \left\|I_P - Q^H V B B^H V^H Q\right\|_F^2 \quad \text{s.t.} \quad [Q]_{n,p} \in \mathcal{Q}, \forall n, p$$

---

## Simulation Results and Performance Metrics

### A. System Parameters

| Parameter | Value | Description |
|-----------|-------|-------------|
| Central Frequency | 28 GHz | Millimeter-wave band |
| Elements per Microstrip | N = 128 | Number of metasurface elements per RF chain |
| Number of RF Chains | M ∈ {4, 8} | Variable across simulations |
| Inter-antenna Spacing | d = λ/2 | Half-wavelength spacing |
| Channel Paths | L = 3 | Number of multipath components |
| User/Scatter Locations | ϑ, φ ∈ [-1, 1], r ∈ [5, 100] | Parameter ranges |
| Transmit Power | 1 | Normalized unit |
| SNR Range | -20 to 12 dB | Signal-to-noise ratio variation |
| Pilot Symbols | P ∈ {10, 20} | Number of training symbols |
| Dictionary Samples (Global) | G = 2N × R × 2M | Total angle-distance samples |
| Dictionary Samples (Azimuth) | g = 2N | Azimuth angle samples |
| Distance Samples | R = 20 | Azimuth distance resolution |

### B. Performance Metrics

**Normalized Mean Square Error (NMSE):**
$$\text{NMSE} = \mathbb{E}\left\{\frac{\|\hat{h} - h\|_2^2}{\|h\|_2^2}\right\}$$

### C. Key Findings from Simulations

#### 1. Model Accuracy (Element Distance Analysis)

- **128 × 8 UPA Configuration:**
  - Oblong Approximation: Achieves excellent alignment with spherical wavefront model
  - Second-order Taylor Approximation: Very similar performance to Oblong Approximation
  - Planar Wavefront: Significant discrepancy, approximately 0.015-0.02 meter error
  - Error magnitude reduces as distance increases

- **128 × 32 UPA Configuration:**
  - Gap between Second-order and Oblong Approximation becomes more evident
  - Both remain within acceptable error ranges
  - Oblong Approximation achieves greater simplification without significant accuracy loss

#### 2. Beamforming Gain Performance

- **At ϑ = φ = 0.25:**
  - Oblong and Second-order Taylor approaches converge to beamforming gain of 1.0 at approximately 5 meters
  - Planar wavefront model exhibits significant degradation below 50 meters
  - Near-field effects become negligible beyond 5 meters for this parameter set

- **At ϑ = φ = 0.5:**
  - Increasing EL elements from 8 to 32 causes only minor performance degradation
  - Validates effectiveness of Oblong Approximation for oblong-shaped arrays

#### 3. Channel Estimation Performance (NMSE Results)

**Configuration: M = 4, P = 20, SNR = -20 to 12 dB**

| Method | SNR = -20 dB | SNR = 0 dB | SNR = 12 dB |
|--------|--------------|-----------|------------|
| Oracle LS (Lower Bound) | ~10^-5 | ~10^-5 | ~10^-5 |
| OG-EL-AZ-DE (Best Method) | ~10^-2 | ~10^-3 | ~8×10^-3 |
| EL-AZ-DE | ~10^-2 | ~10^-3 | ~1.5×10^-2 |
| EL-AZ-JE | ~10^-1 | ~10^-2 | ~3×10^-2 |
| AZ-IE | ~1 | ~0.1 | ~0.05 |

**Key Observations:**
- OG-EL-AZ-DE outperforms all other methods across all SNR settings
- Off-grid refinement procedure significantly improves performance at high SNR
- Large-scale dictionary approach (EL-AZ-JE) suffers from search redundancy at low SNR
- AZ-individual estimation fails to exploit near-field spatial characteristics

#### 4. Impact of Lorentzian Constraint (DMAs vs Phased Arrays)

- **Performance Degradation Factor:** Approximately 2× NMSE increase
- **Example:** At SNR = 12 dB with optimal measurement matrix:
  - Phased Array (OG-EL-AZ-DE): NMSE ≈ 4×10^-3
  - DMA (OG-EL-AZ-DE): NMSE ≈ 8×10^-3
- **Fundamental Cause:** Lorentzian constraint restricts feasible phase range to [0, π]

#### 5. Effect of Number of Measurements (P)

| Configuration | P = 10 | P = 20 |
|---------------|--------|--------|
| M = 4 | Performance loss ~10-15% | Baseline performance |
| M = 8 | Slight improvement | Better performance |

#### 6. Effect of Number of RF Chains (M)

- **M = 4 (fewer RF chains):** Standard baseline performance
- **M = 8 (more RF chains):** Slight improvement from enhanced array gain
- **Trade-off:** Increased complexity vs marginal performance gain

#### 7. Impact of Measurement Matrix Optimization (MMO)

- **With MMO (optimized):** NMSE improved by approximately 20-30% across SNR range
- **Without MMO (random Gaussian):** Baseline degraded performance
- **Optimization criterion:** Minimizes total coherence between measurement matrix and dictionary

#### 8. Computational Complexity

| Method | Complexity | Running Time (at N=256) |
|--------|-----------|------------------------|
| AZ-IE | O(N) | ~1.0 second |
| EL-AZ-DE | O(N) | ~1.2 seconds |
| OG-EL-AZ-DE | O(N) with constant overhead | ~1.86 seconds |
| EL-AZ-JE | O(N) with large coefficient | ~35+ seconds |

**Linear Complexity:** All methods exhibit linear time complexity with respect to metasurface elements, making them scalable for XL-MIMO systems.

---

## Technical Specifications and Design Methodologies

### A. Dynamic Metasurface Antenna (DMA) Architecture

#### 1. Physical Structure
- **Configuration:** Multiple one-dimensional microstrip waveguides
- **Elements:** Reconfigurable metamaterial radiating elements
- **Connection:** Each RF chain connected to a microstrip containing N metasurface elements
- **Dimension:** Typically M RF chains × N elements per microstrip = M×N total elements

#### 2. Operating Principle
- Each element acts as a resonant electrical circuit
- Frequency-selective responses based on metamaterial properties
- Frequency-dependent impedance allows phase adjustment through resonant frequency tuning
- Signal propagation through waveguide undergoes attenuation and phase shift

#### 3. Key Physical Parameters
- **Resonant Frequency:** Tunable via metamaterial design
- **Attenuation Coefficient (αm):** Loss per unit length on microstrip m
- **Wavenumber (βm):** Propagation constant on microstrip m
- **Element Location (ρm,n):** Position-dependent propagation effects

#### 4. Advantages over Conventional Phased Arrays
- Reduced power consumption: No need for independent RF chains per element
- Lower hardware costs: Single microstrip serves multiple elements
- Reconfigurable beam patterns: By adjusting element resonant frequencies
- Simpler feed network: Waveguide-based architecture

### B. Near-Field System Characteristics

#### 1. Fraunhofer Distance (Rayleigh Distance)
- Determines boundary between near- and far-field regions
- Larger for XL-MIMO systems due to extended aperture
- Affects applicability of conventional planar-wave assumptions

#### 2. Near-Field Effects
- Spherical wavefront propagation dominates
- Phase variation non-linear across array aperture
- Distance to target becomes estimation parameter alongside angles
- Critical for objects within typical communication coverage range

#### 3. Elevation-Azimuth (EL-AZ) Parameterization
- **Azimuth (AZ):** Horizontal directional parameter
- **Elevation (EL):** Vertical directional parameter
- **Distance (r):** Range to target object

### C. Oblong Approximation Model - Design Rationale

#### 1. Hardware Configuration Insight
- RF chains typically fewer than microstrip elements (M << N)
- Analog RF end senses azimuth direction (y-axis, many elements)
- Baseband digital end processes elevation direction (z-axis, few RF chains)
- Naturally aligns with EL-AZ parameter separation

#### 2. Mathematical Justification
- Quadratic distance terms ($m^2$, $mn$) much smaller than ($n^2$)
- Elevation direction has minimal impact on distance component
- Decoupling achieved by neglecting cross terms ($m^2$, $mn$, $mn$ coupling)

#### 3. Model Components

**Azimuth Component:** Near-field spherical-wave model
- Captures distance-dependent phase variation along y-axis
- Quadratic phase terms included

**Elevation Component:** Far-field planar-wave model
- Simplified linear phase variation along z-axis
- Adequate given limited RF chains (fewer elements)

#### 4. Advantages
- Reduces coupled parameters from {θ, φ, r} to separate {φ, r} and {ϑ}
- Simplifies signal processing compared to spherical wavefront model
- Kronecker product structure enables parallelizable algorithms
- Maintains accuracy comparable to second-order Taylor expansion
- Better suited to XL-DMA hardware architecture

### D. Channel Estimation Frameworks

#### 1. EL-AZ-Joint Estimation (EL-AZ-JE)

**Formulation:**
- Single-stage compressive sensing problem
- Simultaneously estimates all parameters {ϑ, φ, r}
- Uses large-scale combined dictionary

**Advantages:**
- Direct global optimization
- Conceptually simple

**Disadvantages:**
- Computationally expensive: Large dictionary size
- Dictionary redundancy effects
- Poor performance at low SNR
- High complexity: O(G × MN) where G = 2N × R × 2M

#### 2. Azimuth-Individual Estimation (AZ-IE)

**Formulation:**
- Per-microstrip parameter estimation
- Each RF chain independently estimates {φ, r}
- No explicit elevation parameter recovery

**Advantages:**
- Significantly reduced complexity
- Low computational burden

**Disadvantages:**
- Ignores elevation information processing
- Cannot exploit multi-RF chain diversity
- Misses near-field spatial structure
- Suboptimal performance

#### 3. EL-AZ-Decoupled Estimation (EL-AZ-DE)

**Two-stage procedure:**

**Stage 1 - Azimuth (Near-field):**
- Joint estimation across all RF chains
- Distributed compressive sensing formulation
- Estimates {φ, r} parameters
- Exploits shared support structure

**Stage 2 - Elevation (Far-field):**
- Single-angle search for each path
- Parallelizable across paths
- Uses Kronecker product structure

**Advantages:**
- Leverages both RF-chain diversity and spatial structure
- Moderate computational complexity
- Exploits near-field effect efficiently
- Linear complexity in N

**Disadvantages:**
- Dictionary mismatch due to off-grid parameter distribution
- Two-stage separation may lose some coupling benefits

#### 4. Off-Grid Distributed OLS (OG-DOLS)

**Algorithm Components:**

**Atom Identification Phase:**
- Greedy selection of best angle-distance candidate
- Minimizes residual norm across all RF chains jointly
- Selection criterion: $l^* = \arg\min_{l \in \mathcal{L}} \sum_{m=1}^{M} \left\|\tilde{\Phi}^{(l),\perp}_{m} y_m\right\|_2^2$

**Off-Grid Refinement Phase:**
- First-order Taylor expansion-based parameter adjustment
- Separate refinement for angle and distance parameters
- Accounts for finite dictionary resolution
- Iterative refinement with permutation-based optimization

**Advantages:**
- Addresses dictionary mismatch problem
- Super-resolution parameter recovery
- Significant performance improvement at high SNR
- ~10 dB NMSE gain versus OLS-only approach

### E. Measurement Matrix Optimization (MMO)

#### 1. Optimization Criterion
- **Objective:** Minimize total coherence
- **Metric:** $\|I_g - B^H \tilde{W}^H \tilde{W} B\|_F^2$
- **Coherence Definition:** Maximum correlation between dictionary atoms

#### 2. Problem Formulation

**Stage 1 - Unconstrained Optimization:**
$$\arg\min_{\tilde{\Phi}} \|I_P - \tilde{\Phi}\tilde{\Phi}^H\|_F^2$$
Solution: $\tilde{\Phi} = \sigma_P^2 U_1[I_P, 0_{P,g-P}]^T U_2^H$

**Stage 2 - Constrained Optimization (with Lorentzian Constraint):**
$$\arg\min_Q \left\|\tilde{\Phi} - Q^H V B\right\|_F^2, \quad [Q]_{n,p} \in \mathcal{Q}$$

#### 3. Optimization Algorithm

**Element-wise Closed-Form Solution:**
$$[\hat{F}]_{p,n} = \frac{\nu_{p,n}}{|\nu_{p,n}|}$$

where $\nu_{p,n} = [X_2]_{p,n} - \sum_{\bar{n} \neq n} [X_1]_{\bar{n},n}[\hat{F}]_{p,\bar{n}}$

#### 4. Performance Impact
- Improvement: 20-30% NMSE reduction across SNR range
- Beam pilot optimization: Adaptive selection of measurement (pilot) beams
- Lorentzian constraint handling: Phase alignment approach

---

## Design Techniques and Methodologies

### A. Parameter Estimation Approach

**Sparse Signal Processing Framework:**
- Channel modeled as sparse in angle-distance domain
- Leverages limited number of multipath components (L << Dictionary size)
- Enables compression compared to full channel matrix estimation

**Distributed Signal Processing:**
- Exploits multi-RF-chain structure
- Joint processing of measurements across chains
- Efficient utilization of spatial diversity

### B. Near-Field Effect Characterization

**Two-Component Modeling:**
- **Angle Component:** Directional information (planar wavefront approximation for EL)
- **Distance Component:** Range information (quadratic phase variation for AZ)

**Quadratic Phase Effects:**
- Dominant term: $\frac{((n-1)d)^2}{2r}(1-\varphi^2)$ for azimuth
- Provides distance resolution in near-field region
- Distinguishes targets at different ranges

### C. Algorithmic Design Principles

**Greedy Column Selection:**
- Orthogonal Least Squares (OLS) vs Orthogonal Matching Pursuit (OMP)
- OLS minimizes residual norm
- More effective than atom-residual correlation criteria

**Off-Grid Parameter Refinement:**
- Addresses finite dictionary resolution limitation
- First-order Taylor approximation linearization
- Permutation-based optimization for discrete parameter space

**Parallel Processing:**
- Elevation angle search: Parallelizable across paths
- Multiple RF chains: Distributed processing capability
- Scalable complexity: O(N) per metasurface element

### D. Practical Implementation Considerations

#### 1. Lorentzian Constraint Handling

**Constraint Description:**
- All phases in [0, π] must have distinct, non-adjustable amplitudes
- Phase-amplitude relationship: $q = \frac{1 + e^{jx}}{2}$ for $x \in [0, 2\pi]$
- Restricts weight feasibility compared to ideal phased arrays

**Implementation Strategy:**
- Measurement matrix optimization adapted for LC
- Phase alignment approach: $[\hat{F}]_{n,p} = e^{j\angle[\Psi]_{n,p}}$
- Accepted performance trade-off for power/cost benefits

#### 2. Waveguide Propagation Compensation

**Attenuation Modeling:**
- Position-dependent attenuation: $v_{m,n} = e^{-\rho_{m,n}\alpha_m}$
- Frequency-dependent phase: $e^{-j\beta_m \rho_{m,n}}$
- Requires calibration for accurate channel estimation

#### 3. Dictionary Design

**Global Dictionary (EL-AZ-JE):**
- Samples: 2N azimuth angles × R distance values × 2M elevation angles
- Total atoms: G = 2N × R × 2M
- Resolution trade-off: Finer resolution requires larger dictionary

**Azimuth Dictionary (AZ-IE, AZ part of EL-AZ-DE):**
- Samples: 2N angle samples × R = 20 distance samples
- Per-RF-chain computational burden reduced

**Elevation Search:**
- Fine grid search over elevation angles
- Samples: 2M elevation angles
- Linear search complexity: O(M)

---

## Citations and References

[1] Z. Marzi, D. Ramasamy, and U. Madhow, "Compressive channel estimation and tracking for large arrays in mm-wave picocells," IEEE Journal of Selected Topics in Signal Processing, vol. 10, no. 3, pp. 514–527, 2016.

[2] B. Qi, W. Wang, and B. Wang, "Off-grid compressive channel estimation for mm-wave massive mimo with hybrid precoding," IEEE Communications Letters, vol. 23, no. 1, pp. 108–111, 2019.

[3] S. Yang, C. Xie, D. Wang, and Z. Zhang, "Fast compressive channel estimation for mmwave mimo hybrid beamforming systems," in 2022 IEEE/CIC International Conference on Communications in China (ICCC), 2022, pp. 582–587.

[4] M. Kanaka Chary, C. Vamshi Krishna, and D. Rama Krishna, "Accurate channel estimation and hybrid beamforming using artificial intelligence for massive mimo 5g systems," AEU - International Journal of Electronics and Communications, vol. 173, p. 154971, 2024.

[5] S. Yang, C. Xie, D. Wang, and Z. Zhang, "Fast multibeam training for mmwave mimo systems with subconnected hybrid beamforming architecture," IEEE Systems Journal, vol. 17, no. 2, pp. 2939–2949, 2023.

[6] S. Yang, B. Liu, Z. Hong, and Z. Zhang, "Bayesian optimization-based beam alignment for mmwave mimo communication systems," in 2022 IEEE 33rd Annual International Symposium on Personal, Indoor and Mobile Radio Communications (PIMRC), 2022, pp. 825–830.

[7] W. Wu, D. Liu, X. Hou, and M. Liu, "Low-complexity beam training for 5g millimeter-wave massive mimo systems," IEEE Transactions on Vehicular Technology, vol. 69, no. 1, pp. 361–376, 2020.

[8] O. E. Ayach, S. Rajagopal, S. Abu-Surra, Z. Pi, and R. W. Heath, "Spatially sparse precoding in millimeter wave mimo systems," IEEE Transactions on Wireless Communications, vol. 13, no. 3, pp. 1499–1513, 2014.

[9] D. H. N. Nguyen, L. B. Le, T. Le-Ngoc, and R. W. Heath, "Hybrid mmse precoding and combining designs for mmwave multiuser systems," IEEE Access, vol. 5, pp. 19 167–19 181, 2017.

[10] M. Cui and L. Dai, "Channel estimation for extremely large-scale mimo: Far-field or near-field?" IEEE Transactions on Communications, vol. 70, no. 4, pp. 2663–2677, 2022.

[11] S. Yang, C. Xie, W. Lyu, B. Ning, Z. Zhang, and C. Yuen, "Near-field channel estimation for extremely large-scale reconfigurable intelligent surface (xl-ris)-aided wideband mmwave systems," IEEE Journal on Selected Areas in Communications, vol. 42, no. 6, pp. 1567–1582, 2024.

[12] M. Haghshenas, P. Ramezani, M. Magarini, and E. Björnsson, "Parametric Channel Estimation with Short Pilots in RIS-Assisted Near- and Far-Field Communications," arXiv e-prints, p. arXiv:2308.10668, Aug. 2023.

[13] A. M. Elbir, K. Vijay Mishra, and S. Chatzinotas, "Nba-omp: Near-field beam-split-aware orthogonal matching pursuit for wideband thz channel estimation," in ICASSP 2023 - 2023 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), 2023, pp. 1–5.

[14] A. M. Elbir, W. Shi, A. K. Papazafeiropoulos, P. Kourtessis, and S. Chatzinotas, "Near-field terahertz communications: Model-based and model-free channel estimation," IEEE Access, vol. 11, pp. 36 409–36 420, 2023.

[15] S. Yang, W. Lyu, Z. Hu, Z. Zhang, and C. Yuen, "Channel estimation for near-field xl-ris-aided mmwave hybrid beamforming architectures," IEEE Transactions on Vehicular Technology, vol. 72, no. 8, pp. 11 029–11 034, 2023.

[16] W. Yu, Y. Shen, H. He, X. Yu, J. Zhang, and K. B. Letaief, "Hybrid far- and near-field channel estimation for thz ultra-massive mimo via fixed point networks," in GLOBECOM 2022 - 2022 IEEE Global Communications Conference, 2022, pp. 5384–5389.

[17] B. Friedlander, "Localization of signals in the near-field of an antenna array," IEEE Transactions on Signal Processing, vol. 67, no. 15, pp. 3885–3893, 2019.

[18] A. M. Elbir, K. Vijay Mishra, and S. Chatzinotas, "Spherical Wavefront Near-Field DoA Estimation in THz Automotive Radar," arXiv e-prints, p. arXiv:2310.16724, Oct. 2023.

[19] S. Yang, X. Chen, Y. Xiu, W. Lyu, Z. Zhang, and C. Yuen, "Performance bounds for near-field localization with widely-spaced multi-subarray mmwave/thz mimo," IEEE Transactions on Wireless Communications, pp. 1–1, 2024.

[20] A. M. Elbir, A. Celik, and A. M. Eltawil, "Near-field Hybrid Beamforming for Terahertz-band Integrated Sensing and Communications," arXiv e-prints, p. arXiv:2309.13984, Sep. 2023.

[21] H. Do, N. Lee, and A. Lozano, "Line-of-sight mimo via intelligent reflecting surface," IEEE Transactions on Wireless Communications, vol. 22, no. 6, pp. 4215–4231, 2023.

[22] Y. Xiu, J. Zhao, W. Sun, M. D. Renzo, G. Gui, Z. Zhang, and N. Wei, "Reconfigurable intelligent surfaces aided mmwave noma: Joint power allocation, phase shifts, and hybrid beamforming optimization," IEEE Transactions on Wireless Communications, vol. 20, no. 12, pp. 8393–8409, 2021.

[23] L. Wei, C. Huang, G. C. Alexandropoulos, C. Yuen, Z. Zhang, and M. Debbah, "Channel estimation for ris-empowered multi-user miso wireless communications," IEEE Transactions on Communications, vol. 69, no. 6, pp. 4144–4157, 2021.

[24] S. Yang, W. Lyu, Y. Xiu, Z. Zhang, and C. Yuen, "Active 3d double-ris-aided multi-user communications: Two-timescale-based separate channel estimation via bayesian learning," IEEE Transactions on Communications, vol. 71, no. 6, pp. 3605–3620, 2023.

[25] H. Xie, B. Gu, D. Li, Z. Lin, and Y. Xu, "Gain without pain: Recycling reflected energy from wireless-powered ris-aided communications," IEEE Internet of Things Journal, vol. 10, no. 15, pp. 13 264–13 280, 2023.

[26] H. Xie, D. Li, and B. Gu, "Enhancing Spectrum Sensing via Reconfigurable Intelligent Surfaces: Passive or Active Sensing and How Many Reflecting Elements are Needed?" arXiv e-prints, p. arXiv:2306.13874, Jun. 2023.

[27] W. Lyu, Y. Xiu, S. Yang, P. L. Yeoh, Y. Li, and Z. Zhang, "Weighted sum age of information minimization in wireless networks with aerial irs," IEEE Transactions on Vehicular Technology, vol. 72, no. 4, pp. 5390–5394, 2023.

[28] N. Shlezinger, G. C. Alexandropoulos, M. F. Imani, Y. C. Eldar, and D. R. Smith, "Dynamic metasurface antennas for 6g extreme massive mimo communications," IEEE Wireless Communications, vol. 28, no. 2, pp. 106–113, 2021.

[29] H. Zhang, N. Shlezinger, F. Guidi, D. Dardari, M. F. Imani, and Y. C. Eldar, "Near-field wireless power transfer with dynamic metasurface antennas," in 2022 IEEE 23rd International Workshop on Signal Processing Advances in Wireless Communication (SPAWC), 2022, pp. 1–5.

[30] D. R. Smith, O. Yurduseven, L. Mancera, P. Bowen, and N. B. Kundtz, "Analysis of a waveguide-fed metasurface antenna," Physical Review Applied, vol. 8, p. 054048, Nov. 2017.

[31] T. Sleasman, M. Boyarsky, M. F. Imani, J. N. Gollub, and D. R. Smith, "Design considerations for a dynamic metamaterial aperture for computational imaging at microwave frequencies," Journal of the Optical Society of America B, vol. 33, no. 6, pp. 1098–1111, Jun. 2016.

[32] N. Shlezinger, O. Dicker, Y. C. Eldar, I. Yoo, M. F. Imani, and D. R. Smith, "Dynamic metasurface antennas for uplink massive mimo systems," IEEE Transactions on Communications, vol. 67, no. 10, pp. 6829–6843, Jul. 2019.

[33] H. Wang, N. Shlezinger, Y. C. Eldar, S. Jin, M. F. Imani, I. Yoo, and D. R. Smith, "Dynamic metasurface antennas for mimo-ofdm receivers with bit-limited adcs," IEEE Transactions on Communications, vol. 69, no. 4, pp. 2643–2659, Nov. 2021.

[34] L. You, J. Xu, G. C. Alexandropoulos, J. Wang, W. Wang, and X. Gao, "Energy efficiency maximization of massive mimo communications with dynamic metasurface antennas," IEEE Transactions on Wireless Communications, vol. 22, no. 1, pp. 393–407, Aug. 2023.

[35] S. F. Kimaryo and K. Lee, "Downlink beamforming for dynamic metasurface antennas," IEEE Transactions on Wireless Communications, vol. 22, no. 7, pp. 4745–4755, Dec. 2022.

[36] H. Zhang, N. Shlezinger, F. Guidi, D. Dardari, M. F. Imani, and Y. C. Eldar, "Beam focusing for near-field multiuser mimo communications," IEEE Transactions on Wireless Communications, vol. 21, no. 9, pp. 7476–7490, 2022.

[37] Q. Yang, A. Guerra, F. Guidi, N. Shlezinger, H. Zhang, D. Dardari, B. Wang, and Y. C. Eldar, "Near-field localization with dynamic metasurface antennas," in ICASSP 2023 - 2023 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), May. 2023, pp. 1–5.

---

## End of Extracted Content

*This document contains comprehensive extracted content from the research paper including all figures with captions, technical tables, complete mathematical equations, simulation results with detailed performance metrics, technical specifications, design methodologies, and full citation references.*
